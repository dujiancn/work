select p.product_id,pr.provider_id,pr.name,pr.how_to_book,pr.reservation_note from product p LEFT JOIN provider pr ON p.provider_id=pr.provider_id WHERE p.product_id IN ( select product_id from product_free_sale where is_free_sale =1) OR (p.provider_id IN (select provider_id from provider_free_sale where is_free_sale=1) AND p.product_id NOT IN (select product_id from product_free_sale where is_free_sale =0) );
